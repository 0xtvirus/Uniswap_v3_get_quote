This code fully depends on the price calculation methods from TWAP as explained by Smart Contract Programmer in below links:
https://www.youtube.com/watch?v=tGW8MoiNj54&list=PLO5VPQH6OWdX-Rh7RonjZhOd9pb9zOnHW&index=31
https://github.com/t4sk/uniswap-v3-twap/tree/main/contracts
https://github.com/stakewithus/notes/blob/main/excalidraw/uniswap-v3-twap.png